<!DOCTYPE html>
<html lang="en-us">
  <head>
    
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="author" content="Cornelius Aschermann">
<meta name="keywords" content="">
<meta name="description" content="Release of Nautilus 2.0 with many new features">


<meta property="og:description" content="Release of Nautilus 2.0 with many new features">
<meta property="og:type" content="article">
<meta property="og:title" content="Nautilus 2.0">
<meta name="twitter:title" content="Nautilus 2.0">
<meta property="og:url" content="https://hexgolems.com/2020/04/nautilus-2.0/">
<meta property="twitter:url" content="https://hexgolems.com/2020/04/nautilus-2.0/">
<meta property="og:site_name" content="Hexgolems">
<meta property="og:description" content="Release of Nautilus 2.0 with many new features">
<meta name="twitter:description" content="Release of Nautilus 2.0 with many new features">
<meta property="og:locale" content="en">

  
    <meta property="article:published_time" content="2020-04-01T00:00:00">
  
  
    <meta property="article:modified_time" content="2020-04-01T00:00:00">
  
  
  
  
    
      <meta property="article:tag" content="fuzzing">
    
      <meta property="article:tag" content="github">
    
      <meta property="article:tag" content="rust">
    
  


<meta name="twitter:card" content="summary">

  <meta name="twitter:site" content="@is_eqv">


  <meta name="twitter:creator" content="@is_eqv">







  <meta property="og:image" content="https://hexgolems.com/imgs/avatar.png">
  <meta property="twitter:image" content="https://hexgolems.com/imgs/avatar.png">



  <meta property="og:image" content="https://hexgolems.com/imgs/nautilus_img.png">
  <meta property="twitter:image" content="https://hexgolems.com/imgs/nautilus_img.png">


  <meta property="og:image" content="https://hexgolems.com/imgs/nautilus_img.png">
  <meta property="twitter:image" content="https://hexgolems.com/imgs/nautilus_img.png">



    <title>Nautilus 2.0</title>

    <link rel="icon" href="https://hexgolems.com/favicon.png">
    

    

    <link rel="canonical" href="https://hexgolems.com/2020/04/nautilus-2.0/">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/jquery.fancybox.min.css" integrity="sha256-vuXZ9LGmmwtjqFX1F+EKin1ThZMub58gKULUyf0qECk=" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.4/helpers/jquery.fancybox-thumbs.min.css" integrity="sha256-SEa4XYAHihTcEP1f5gARTB2K26Uk8PsndQYHQC1f4jU=" crossorigin="anonymous" />
    
    
    <link rel="stylesheet" href="https://hexgolems.com/css/style-twzjdbqhmnnacqs0pwwdzcdbt8yhv8giawvjqjmyfoqnvazl0dalmnhdkvp7.min.css" />
    
    

    
      
    
    
  </head>

  <body>
    <div id="blog">
      <header id="header" data-behavior="5">
  <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
  <div class="header-title">
    <a class="header-title-link" href="https://hexgolems.com/">Hexgolems</a>
  </div>
  
    
      <a class="header-right-icon "
         href="https://hexgolems.com/#about">
    
    
      <i class="fa fa-2x fa-user"></i>
    
    
    </a>
  
</header>

      <nav id="sidebar" data-behavior="5">
  <div class="sidebar-container">
    
      <div class="sidebar-profile">
        <a href="https://hexgolems.com/#about">
          <img class="sidebar-profile-picture" src="https://hexgolems.com/imgs/avatar.png" alt="" />
        </a>
        <h4 class="sidebar-profile-name">Cornelius Aschermann</h4>
        
          <h5 class="sidebar-profile-bio">Fuzzing, Reverse Engineering, Binary Analysis</h5>
        
      </div>
    
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://hexgolems.com/">
    
      <i class="sidebar-button-icon fa fa-lg fa-home"></i>
      
      <span class="sidebar-button-desc">Home</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://hexgolems.com/#about">
    
      <i class="sidebar-button-icon fa fa-lg fa-question"></i>
      
      <span class="sidebar-button-desc">About</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://hexgolems.com/tags/github">
    
      <i class="sidebar-button-icon fa fa-lg fa-github"></i>
      
      <span class="sidebar-button-desc">GitHub</span>
    </a>
  </li>

  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://twitter.com/is_eqv" target="_blank" rel="noopener">
    
      <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
      
      <span class="sidebar-button-desc">Twitter</span>
    </a>
  </li>


    </ul>
    <ul class="sidebar-buttons">
      
  <li class="sidebar-button">
    
      <a class="sidebar-button-link " href="https://hexgolems.com/index.xml">
    
      <i class="sidebar-button-icon fa fa-lg fa-rss"></i>
      
      <span class="sidebar-button-desc">RSS</span>
    </a>
  </li>


    </ul>
  </div>
</nav>

      
  <div class="post-header-cover
              text-center
              post-header-cover--partial"
       style="background-image:url('/imgs/nautilus_img.png')"
       data-behavior="5">
    
  </div>


      <div id="main" data-behavior="5"
        class="hasCover
               hasCoverMetaOut
               ">
        <article class="post" itemscope itemType="http://schema.org/BlogPosting">
          
          
            <div class="post-header main-content-wrap text-center">
  
    <h1 class="post-title" itemprop="headline">
      Nautilus 2.0
    </h1>
  
  
  <div class="postShorten-meta post-meta">
    
      <time itemprop="datePublished" datetime="2020-04-01T00:00:00Z">
        April, 2020

      </time>
    
    
  </div>

</div>
          
          <div class="post-content markdown" itemprop="articleBody">
            <div class="main-content-wrap">
              <p align=center><a href="https://github.com/nautilus-fuzz/nautilus" class="post-action-btn btn btn--primary" text-align="center"><i class="fa fa-github" aria-hidden="true"></i> View On Github</a></p>
<h1 id="nautilus-20">Nautilus 2.0</h1>
<p>We are glad to announce the released of v2.0 of our fuzzer Nautilus!</p>
<p>Nautilus is a coverage guided, grammar based fuzzer. You can use it to improve your test coverage and find more bugs. By specifying the grammar of semi valid inputs, Nautilus is able to perform complex mutation and to uncover more interesting test cases. Many of the ideas behind this fuzzer are documented in a Paper published at NDSS 2019.</p>
<p>
<a href="https://www.syssec.ruhr-uni-bochum.de/media/emma/veroeffentlichungen/2018/12/17/NDSS19-Nautilus.pdf"> <img align="right" width="200"  src="https://github.com/RUB-SysSec/nautilus/raw/master/paper.png"> </a>
</p>
<p>Version 2.0 has added many improvements to this early prototype and is now 100% compatible with AFL++. Besides general usability improvements, Version 2.0 includes lots of shiny new features:</p>
<ul>
<li>Support for AFL-Qemu mode</li>
<li>Support for grammars specified in python</li>
<li>Support for non-context free grammars using python scripts to generate inputs from the structure</li>
<li>Support for specifying binary protocols/formats</li>
<li>Support for specifying regex based terminals that aren&rsquo;t part of the directed mutations</li>
<li>Better ability to avoid generating the same very short inputs over and over</li>
<li>Easier setup</li>
<li>Massive cleanup of the code base</li>
<li>Helpful error output on invalid grammars</li>
<li>Fixed a bug in the the timeout code that occasionally deadlocked the fuzzer</li>
</ul>
<h2 id="how-does-nautilus-work">How Does Nautilus Work?</h2>
<p>You specify a grammar using rules such as <code>EXPR -&gt; EXPR + EXPR</code> or <code>EXPR -&gt; NUM</code> and <code>NUM -&gt; 1</code>. From these rules, the fuzzer constructs a tree. This internal representation allows to apply much more complex mutations than raw bytes. This tree is then turned into a real input for the target application. In normal Context Free Grammars, this process is straightforward: all leaves are concatenated. The left tree in the example below would unparse to the input <code>a=1+2</code> and the right one to <code>a=1+1+1+2</code>. To increase the expressiveness of your grammars, using Nautilus you are able to provide python functions for the unparsing process to allow much more complex specifications.</p>
<p align="center">
<img width="400" align="center" src="https://github.com/RUB-SysSec/nautilus/raw/master/tree.png">
</p>
<h2 id="setup">Setup</h2>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># checkout the git</span>
git clone <span style="color:#e6db74">&#39;git@github.com:nautilus-fuzz/nautilus.git&#39;</span>
cd nautilus
/path/to/AFLplusplus/afl-clang-fast test.c -o test <span style="color:#75715e">#afl-clang-fast as provided by AFL</span>

<span style="color:#75715e"># all arguments can also be set using the config.ron file</span>
cargo run --release -- -g grammars/grammar_py_exmaple.py -o /tmp/workdir -- ./test @@

<span style="color:#75715e"># or if you want to use QEMU mode:</span>
cargo run /path/to/AFLplusplus/afl-qemu-trace -- ./test_bin @@

</code></pre></div><h2 id="examples">Examples</h2>
<p>Here, we use python to generate a grammar for valid xml-like inputs. Notice the use of a script rule to ensure the the opening
and closing tags match.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#75715e">#ctx.rule(NONTERM: string, RHS: string|bytes) adds a rule NONTERM-&gt;RHS. We can use {NONTERM} in the RHS to request a recursion. </span>
ctx<span style="color:#f92672">.</span>rule(<span style="color:#e6db74">&#34;START&#34;</span>,<span style="color:#e6db74">&#34;&lt;document&gt;{XML_CONTENT}&lt;/document&gt;&#34;</span>)
ctx<span style="color:#f92672">.</span>rule(<span style="color:#e6db74">&#34;XML_CONTENT&#34;</span>,<span style="color:#e6db74">&#34;{XML}{XML_CONTENT}&#34;</span>)
ctx<span style="color:#f92672">.</span>rule(<span style="color:#e6db74">&#34;XML_CONTENT&#34;</span>,<span style="color:#e6db74">&#34;&#34;</span>)

<span style="color:#75715e">#ctx.script(NONTERM:string, RHS: [string]], func) adds a rule NONTERM-&gt;func(*RHS). </span>
<span style="color:#75715e"># In contrast to normal `rule`, RHS is an array of nonterminals. </span>
<span style="color:#75715e"># It&#39;s up to the function to combine the values returned for the NONTERMINALS with any fixed content used.</span>
ctx<span style="color:#f92672">.</span>script(<span style="color:#e6db74">&#34;XML&#34;</span>,[<span style="color:#e6db74">&#34;TAG&#34;</span>,<span style="color:#e6db74">&#34;ATTR&#34;</span>,<span style="color:#e6db74">&#34;XML_CONTENT&#34;</span>], <span style="color:#66d9ef">lambda</span> tag,attr,body: <span style="color:#e6db74">b</span><span style="color:#e6db74">&#34;&lt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74"> </span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&lt;/</span><span style="color:#e6db74">%s</span><span style="color:#e6db74">&gt;&#34;</span><span style="color:#f92672">%</span>(tag,attr,body,tag) )
ctx<span style="color:#f92672">.</span>rule(<span style="color:#e6db74">&#34;ATTR&#34;</span>,<span style="color:#e6db74">&#34;foo=bar&#34;</span>)
ctx<span style="color:#f92672">.</span>rule(<span style="color:#e6db74">&#34;TAG&#34;</span>,<span style="color:#e6db74">&#34;some_tag&#34;</span>)
ctx<span style="color:#f92672">.</span>rule(<span style="color:#e6db74">&#34;TAG&#34;</span>,<span style="color:#e6db74">&#34;other_tag&#34;</span>)

<span style="color:#75715e">#sometimes we don&#39;t want to explore the set of possible inputs in more detail. For example, if we fuzz a script</span>
<span style="color:#75715e">#interpreter, we don&#39;t want to spend time on fuzzing all different variable names. In such cases we can use Regex</span>
<span style="color:#75715e">#terminals. Regex terminals are only mutated during generation, but not during normal mutation stages, saving a lot of time. </span>
<span style="color:#75715e">#The fuzzer still explores different values for the regex, but it won&#39;t be able to learn interesting values incrementally. </span>
<span style="color:#75715e">#Use this when incremantal exploration would most likely waste time.</span>

ctx<span style="color:#f92672">.</span>regex(<span style="color:#e6db74">&#34;TAG&#34;</span>,<span style="color:#e6db74">&#34;[a-z]+&#34;</span>)
</code></pre></div><p>To test your grammars you can use the generator:</p>
<pre><code>$ cargo run --bin generator -- -g grammars/test.py -t 100 
&lt;document&gt;&lt;some_tag foo=bar&gt;&lt;other_tag foo=bar&gt;&lt;other_tag foo=bar&gt;&lt;some_tag foo=bar&gt;&lt;/some_tag&gt;&lt;/other_tag&gt;&lt;some_tag foo=bar&gt;&lt;other_tag foo=bar&gt;&lt;/other_tag&gt;&lt;/some_tag&gt;&lt;other_tag foo=bar&gt;&lt;/other_tag&gt;&lt;some_tag foo=bar&gt;&lt;/some_tag&gt;&lt;/other_tag&gt;&lt;other_tag foo=bar&gt;&lt;/other_tag&gt;&lt;some_tag foo=bar&gt;&lt;/some_tag&gt;&lt;/some_tag&gt;&lt;/document&gt;
</code></pre><p>You can also use Nautilus in combination with AFL. Simply point AFL <code>-o</code> to the same workdir, and AFL will synchronize
with Nautilus. Note that this is one way. AFL imports Nautilus inputs, but not the other way around.</p>
<pre><code>#Terminal/Screen 1
./afl-fuzz -Safl -i /tmp/seeds -o /tmp/workdir/ ./test @@

#Terminal/Screen 2
cargo run --release -- -o /tmp/workdir -- ./test @@
</code></pre>
              
            </div>
          </div>
          <div id="post-footer" class="post-footer main-content-wrap">
            
              
                
                
                  <div class="post-footer-tags">
                    <span class="text-color-light text-small"></span><br/>
                    
  <a class="tag tag--primary tag--small" href="https://hexgolems.com/tags/fuzzing/">fuzzing</a>

  <a class="tag tag--primary tag--small" href="https://hexgolems.com/tags/github/">github</a>

  <a class="tag tag--primary tag--small" href="https://hexgolems.com/tags/rust/">rust</a>

                  </div>
                
              
            
            <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://hexgolems.com/2020/04/incorrectness-logic-by-example/" data-tooltip="Incorrectness Logic by Example">
              
                  
                  &lt;
                  
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://hexgolems.com/2019/12/hotfuzz/" data-tooltip="HotFuzz">
              
              
                  &gt;
                  
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

            
              
            
          </div>
        </article>
        <footer id="footer" class="main-content-wrap">
  <span class="copyrights">
    &copy; 2020 Cornelius Aschermann. 
  </span>
</footer>

      </div>
      <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
        <div class="post-actions-wrap">
  
      <nav >
        <ul class="post-actions post-action-nav">
          
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://hexgolems.com/2020/04/incorrectness-logic-by-example/" data-tooltip="Incorrectness Logic by Example">
              
                  
                  &lt;
                  
                </a>
            </li>
            <li class="post-action">
              
                <a class="post-action-btn btn btn--default tooltip--top" href="https://hexgolems.com/2019/12/hotfuzz/" data-tooltip="HotFuzz">
              
              
                  &gt;
                  
                </a>
            </li>
          
        </ul>
      </nav>
    <ul class="post-actions post-action-share" >
      
      
      <li class="post-action">
        
          <a class="post-action-btn btn btn--default" href="#">
        
          <i class="fa fa-list"></i>
        </a>
      </li>
    </ul>
  
</div>

      </div>
      <div id="share-options-bar" class="share-options-bar" data-behavior="5">
  <i id="btn-close-shareoptions" class="fa fa-close"></i>
  <ul class="share-options">
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fhexgolems.com%2F2020%2F04%2Fnautilus-2.0%2F">
          <i class="fa fa-facebook-official"></i><span>%!(EXTRA string=Facebook)</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=https%3A%2F%2Fhexgolems.com%2F2020%2F04%2Fnautilus-2.0%2F">
          <i class="fa fa-twitter"></i><span>%!(EXTRA string=Twitter)</span>
        </a>
      </li>
    
      <li class="share-option">
        <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=https%3A%2F%2Fhexgolems.com%2F2020%2F04%2Fnautilus-2.0%2F">
          <i class="fa fa-google-plus"></i><span>%!(EXTRA string=Google&#43;)</span>
        </a>
      </li>
    
  </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
    </div>
    
    <div id="about">
  <div id="about-card">
    <div id="about-btn-close">
      <i class="fa fa-remove"></i>
    </div>
    
      <img id="about-card-picture" src="https://hexgolems.com/imgs/avatar.png" alt="" />
    
    <h4 id="about-card-name">Cornelius Aschermann</h4>
    
      <div id="about-card-bio">Fuzzing, Reverse Engineering, Binary Analysis</div>
    
    
      <div id="about-card-job">
        <i class="fa fa-briefcase"></i>
        <br/>
        Security Researcher
      </div>
    
    
      <div id="about-card-location">
        <i class="fa fa-map-marker"></i>
        <br/>
        Germany
      </div>
    
  </div>
</div>

    

    
  
    
      <div id="cover" style="background-image:url('https://hexgolems.com/imgs/dark_bg.jpg');"></div>
    
  


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.7/js/jquery.fancybox.min.js" integrity="sha256-GEAnjcTqVP+vBp3SSc8bEDQqvWAZMiHyUSIorrWwH50=" crossorigin="anonymous"></script>


<script src="https://hexgolems.com/js/script-pcw6v3xilnxydl1vddzazdverrnn9ctynvnxgwho987mfyqkuylcb1nlt.min.js"></script>


<script lang="javascript">
window.onload = updateMinWidth;
window.onresize = updateMinWidth;
document.getElementById("sidebar").addEventListener("transitionend", updateMinWidth);
function updateMinWidth() {
  var sidebar = document.getElementById("sidebar");
  var main = document.getElementById("main");
  main.style.minWidth = "";
  var w1 = getComputedStyle(main).getPropertyValue("min-width");
  var w2 = getComputedStyle(sidebar).getPropertyValue("width");
  var w3 = getComputedStyle(sidebar).getPropertyValue("left");
  main.style.minWidth = `calc(${w1} - ${w2} - ${w3})`;
}
</script>

<script>
$(document).ready(function() {
  hljs.configure({ classPrefix: '', useBR: false });
  $('pre.code-highlight > code, pre > code').each(function(i, block) {
    if (!$(this).hasClass('codeblock')) {
      $(this).addClass('codeblock');
    }
    hljs.highlightBlock(block);
  });
});
</script>


  
    
  




    
  </body>
</html>

